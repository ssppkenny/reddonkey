{"version":3,"sources":["reddonkey/db.cljs"],"mappings":"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","names":["reddonkey.db/in-interval?","a","b","x","p__15770","vec__15772","cljs.core.nth","reddonkey.db/diff-to-action","y","cljs.core._EQ_","p__15778","vec__15780","reddonkey.db/block-to-coords","w","h","xr","cljs.core.range","yr","cljs.core.mapcat","cljs.core/concat","iter__5523__auto__","s__15787","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5521__auto__","size__5522__auto__","cljs.core/count","b__15789","cljs.core/chunk-buffer","i__15788","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__15786","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","s__15795","b__15797","i__15796","iter__15794","s__15803","b__15805","i__15804","iter__15802","p__15810","vec__15811","reddonkey.db/set-zeros","board","coords","new-board","cljs.core.reduce","p__15814","vec__15815","cljs.core.assoc","cljs.core.get","p__15826","vec__15827","reddonkey.db/assign-block","n","p__15830","vec__15831","p__15842","vec__15843","reddonkey.db/fits-zero?","d","new-block","assigned-board","non-zero","cljs.core.filter","cljs.core.not_EQ_","cljs.core/flatten","p__15854","map__15855","cljs.core/--destructure-map","reddonkey.db/next-moves","zero","blocks","vec__15860","vec__15863","vec__15866","x1","y1","x2","y2","moves1","moves2","allowed-moves1","s__15870","b__15872","i__15871","vec__15881","iter__15869","vec__15887","and__5043__auto__","allowed-moves2","s__15894","b__15896","i__15895","vec__15901","iter__15893","vec__15907","allowed-without-zero1","p__15917","vec__15918","allowed-without-zero2","p__15924","vec__15925","actions1","cljs.core.map","p__15931","vec__15936","cljs.core/-","actions2","p__15939","vec__15940","actions-fit1","p__15946","vec__15947","actions-fit2","p__15953","vec__15954","cljs.core/vec","cljs.core/set","cljs.core.concat","reddonkey.db/blocks","reddonkey.db/board","reddonkey.db/initial-state","reddonkey.db/default-db","cljs.core/chunk-first"],"sourcesContent":["(ns reddonkey.db)\n\n(defn in-interval?\n  \"Returns a predicate that tests if its argument falls in\n  the inclusive interval [a, b].\"\n  [a b]\n  (fn [x] (and (>= x a) (<= x b))))\n\n(defn diff-to-action [[x y]]\n  (cond\n    (= [x y] [1 0]) 10\n    (= [x y] [-1 0]) -10\n    (= [x y] [0 1]) 1\n    (= [x y] [0 -1]) -1))\n\n(defn block-to-coords [[x y w h]]\n  (let [xr (range x (+ x w))\n        yr (range y (+ y h))]\n    (mapcat concat (for [x xr] (for [y yr] [x y])))))\n\n(defn set-zeros [board [x y w h]]\n  (let [coords (block-to-coords [x y w h])\n        new-board (reduce (fn [b [x y]] (assoc b y (assoc (get b y) x 0))) board coords)]\n    new-board))\n\n(defn assign-block [board n [x y w h]]\n  (let [coords (block-to-coords [x y w h])\n        new-board (reduce (fn [b [x y]] (assoc b y (assoc (get b y) x n))) board coords)]\n    new-board))\n\n(defn fits-zero? [n d [x y w h] board]\n  (let [new-block (cond\n                    (= d 1) [x (+ y 1) w h]\n                    (= d -1) [x (- y 1) w h]\n                    (= d 10) [(+ x 1) y w h]\n                    (= d -10) [(- x 1) y w h])\n        assigned-board (assign-block (set-zeros board [x y w h]) n new-block)\n        non-zero (filter (fn [x] (not= x 0)) (flatten assigned-board))]\n    (= (count non-zero) 18)))\n\n(defn next-moves [{:keys [board zero blocks]}]\n  (let [[[x1 y1] [x2 y2]] zero\n        moves1 [[(+ x1 1) y1] [(- x1 1) y1] [x1 (+ y1 1)] [x1 (- y1 1)]]\n        moves2 [[(+ x2 1) y2] [(- x2 1) y2] [x2 (+ y2 1)] [x2 (- y2 1)]]\n        allowed-moves1 (for [[a b] moves1 :when (and ((in-interval? 0 3) a) ((in-interval? 0 4) b))] [a b])\n        allowed-moves2 (for [[a b] moves2 :when (and ((in-interval? 0 3) a) ((in-interval? 0 4) b))] [a b])\n        allowed-without-zero1 (filter (fn [[a b]] (and (not (and (= a x1) (= b y1))) (not (and (= a x2) (= b y2))))) allowed-moves1)\n        allowed-without-zero2 (filter (fn [[a b]] (and (not (and (= a x1) (= b y1))) (not (and (= a x2) (= b y2))))) allowed-moves2)\n        actions1 (map (fn [[x y]] [(get (get board y) x) (diff-to-action (map - [x1 y1] [x y]))]) allowed-without-zero1)\n        actions2 (map (fn [[x y]] [(get (get board y) x) (diff-to-action (map - [x2 y2] [x y]))]) allowed-without-zero2)\n        actions-fit1 (filter (fn [[x y]] (fits-zero? x y (get blocks x) board)) actions1)\n        actions-fit2 (filter (fn [[x y]] (fits-zero? x y (get blocks x) board)) actions2)]\n    (vec (set (concat actions-fit1 actions-fit2)))))\n\n(def blocks\n  {1 [0 0 1 2] 2 [1 0 2 2] 3 [3 0 1 2] 4 [0 2 1 2]\n   5 [1 2 2 1] 6 [3 2 1 2] 7 [1 3 1 1] 8 [2 3 1 1]\n   9 [0 4 1 1] 10 [3 4 1 1]})\n\n(def board\n  [[1 2 2 3]\n   [1 2 2 3]\n   [4 5 5 6]\n   [4 7 8 6]\n   [9 0 0 10]])\n\n(def initial-state\n  {:board  board\n   :zero   [[1 4] [2 4]]\n   :blocks blocks})\n\n(def default-db\n  {:name \"re-frame\"\n   :state initial-state})\n"]}